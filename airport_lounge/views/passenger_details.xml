<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="passenger_details_action" model="ir.actions.act_window">
        <field name="name">Passenger Registration</field>
        <field name="res_model">passenger.registration</field>
        <field name="view_mode">tree,form</field>
    </record>


    <record id="passenger_details_view" model="ir.ui.view">
        <field name="name">passenger.registration.form</field>
        <field name="model">passenger.registration</field>
        <field name="arch" type="xml">
            <form string="passenger">
                <header>
                    <field name="state" widget="statusbar"
                           statusbar_visible="draft,register,validate,reject"/>
                    <field name="camera_capture"/>
                    <button name="validate_card" string="Validate Card"
                            type="object" class="oe_highlight"/>
                    <button name="reject_card" string="Reject Card"
                            type="object" class="oe_highlight"/>

                </header>
                <sheet>

                    <group name="Passenger" style="margin-top:10px;">
                        <group>
                            <field name="airline_id"/>


                            <field name="client_id"/>
                            <field name="guest_id" invisible="1"/>

                            <field name="flight_number"/>
                            <field name="first_name"/>
                            <field name="last_name"/>
                            <field name="origin_id"/>
                            <field name="destination_id"/>
                            <field name="passenger"/>
                            <field name="guests"/>
                        </group>

                        <group name="airline" style="margin-top:10px;">
                            <field name="allowed_entry_time"/>
                            <field name="cabin_class_id"/>
                            <field name="frequent_flair_class_id"/>
                            <field name="frequent_passenger_number"/>
                            <field name="seat_number"/>
                            <field name="reservation"/>
                            <field name="date"/>
                            <field name="connection_flight"/>
                            <field name="invitation"/>

                        </group>
                        <group name="code" style="margin-left:645px;">

                            <field name="name"/>
                        </group>


                    </group>


                    <notebook>
                        <page string="Guest" name="guest"
                              attrs="{'invisible': [('guests','!=',True)]}">
                            <field name="guest_ids" mode="kanban"
                                   context="{'default_connection_flight': True,'guests':True,'default_name':name,'default_guest_id':id }">
                                <kanban string="Guest">
                                    <field name="flight_number"/>
                                    <field name="cabin_class_id"/>
                                    <field name="seat_number"/>
                                    <field name="origin_id"/>
                                    <field name="destination_id"/>
                                    <field name="guests"/>
                                    <field name="guest_code"/>
                                    <field name="guest_id"/>


                                    <templates>
                                        <t t-name="kanban-box">
                                            <div>
                                                <div t-attf-class="oe_kanban_global_click">

                                                    <div class="oe_kanban_details">
                                                        <field name="guest_id"/>

                                                        <field name="guest_code"/>


                                                        <div>
                                                            <field name="last_name"/>
                                                            <field name="seat_number"/>
                                                        </div>
                                                        <field name="origin_id"/>
                                                    </div>

                                                </div>

                                            </div>
                                        </t>
                                    </templates>


                                </kanban>
                                <form string="Guest">
                                    <group name="connection_form">
                                        <group>
                                            <field name="airline_id"/>
                                            <field name="flight_number"/>
                                            <field name="first_name"/>
                                            <field name="last_name"/>
                                            <field name="origin_id"/>
                                            <field name="destination_id"/>
                                            <field name="passenger"/>

                                        </group>
                                        <group>
                                            <field name="guest_id"/>

                                            <field name="guest_code"/>

                                            <field name="guests"/>
                                            <field name="child"/>
                                            <field name="allowed_extra_time"/>
                                            <field name="allowed_drink"
                                                   attrs="{'invisible': [('child','!=',False)]}"/>
                                            <field name="cabin_class_id"/>
                                            <field name="reservation"/>
                                            <field name="date"/>
                                            <field name="next_guest_code"
                                                   invisible="1"/>
                                        </group>

                                    </group>

                                </form>
                            </field>

                        </page>
                        <page string="Invitation">
                            <group name="invitation">
                                <field name="email"/>
                                <field name="invitation"/>
                            </group>
                            <group name="Upload">
                                <field name="email_upload"
                                       attrs="{'invisible': [('email','!=',True)]}"/>
                                <field name="invitation_upload"
                                       attrs="{'invisible': [('invitation','!=',True)]}"/>

                            </group>
                        </page>
                        <page name="connection"
                              string="Connection Flight"
                              attrs="{'invisible': [('connection_flight','!=',True)]}">
                            <field name="child_ids" mode="kanban"
                                   context="{'default_connection_flight': True,'default_name':name}">


                                <kanban string="Connection Flight">
                                    <field name="flight_number"/>
                                    <field name="cabin_class_id"/>
                                    <field name="seat_number"/>
                                    <field name="origin_id"/>
                                    <field name="destination_id"/>
                                    <templates>
                                        <t t-name="kanban-box">
                                            <div t-attf-class="oe_kanban_global_click">
                                                <div class="o_kanban_image">
                                                </div>
                                                <div>

                                                    <div class="oe_kanban_details">
                                                        <field name="flight_number"/>

                                                        <div>
                                                            <field name="cabin_class_id"/>
                                                            <field name="seat_number"/>
                                                        </div>
                                                        <field name="origin_id"/>
                                                    </div>


                                                </div>
                                            </div>
                                        </t>
                                    </templates>


                                </kanban>
                                <form>
                                    <group name="connection_flight">
                                        <group>
                                            <field name="airline_id"/>
                                            <field name="flight_number"/>
                                            <field name="first_name"/>
                                            <field name="last_name"/>
                                            <field name="origin_id"/>
                                            <field name="destination_id"/>
                                            <field name="passenger"/>

                                        </group>
                                        <group>
                                            <!--                                            <field name="guest_code"  invisible="context.get('connection_flight')"/>-->

                                            <!--                                            <field name="guest"/>-->
                                            <field name="cabin_class_id"/>
                                            <field name="reservation"/>
                                            <field name="date"/>
                                        </group>

                                    </group>

                                </form>
                            </field>
                        </page>


                    </notebook>


                </sheet>
            </form>
        </field>
    </record>
    <record id="passenger_details_tree_view" model="ir.ui.view">
        <field name="name">passenger.registration.tree</field>
        <field name="model">passenger.registration</field>
        <field name="arch" type="xml">
            <tree string="passenger">

                <field name="client_id"/>
                <field name="airline_id"/>
                <field name="flight_number"/>
                <field name="seat_number"/>
                <field name="cabin_class_id"/>
                <field name="reservation"/>

            </tree>
        </field>
    </record>
    <record id="passenger_search_view" model="ir.ui.view">
        <field name="name">passenger.registration.view.search</field>
        <field name="model">passenger.registration</field>
        <field name="arch" type="xml">
            <search string="passenger">

                <filter name="client_id" string="Client"
                        context="{'group_by':'client_id'}"/>
                <filter name="filter_client_id" string="Client"/>
                <filter name="airline_id" string="Airline"
                        context="{'group_by':'airline_id'}"/>
                <filter name="airline_id" string="Airline"/>
            </search>
        </field>
    </record>

    <!--    <menuitem id="user_registration" action="user_registration_action"-->
    <!--              name="User Registration"-->
    <!--              parent="airport_lounge.airport_lounge_root" sequence="1"/>-->

    <menuitem id="passenger_details" name="Passenger Details"
              action="passenger_details_action" sequence="1"
              parent="airport_lounge.airport_lounge_root"/>
    <menuitem id="passenger_services" name="Services"
              action="passenger_details_action" sequence="3"
              parent="airport_lounge.airport_lounge_root"/>


</odoo>

